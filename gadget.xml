<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs title="test1" author_email="randall@your.domain">
    <Require feature="osapi" />
    
    <Require feature="dynamic-height" />
  </ModulePrefs>
  <Content type="html" view="canvas" preferred_height="2000"><![CDATA[

<link rel="stylesheet" type="text/css" href="styles.css" />
<link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/themes/smoothness/jquery-ui.css" />

<script type="text/javascript" src="http://localhost:8123/OpenSocialGadget-USC/lib.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/jquery-ui.min.js"></script>



First Name: 
<div id='fname'>1</div> 
Last Name:
<div id='lname'>2</div>
URL:
<div id='url'>3</div>
Result Count:
<div id='result'>4</div>
JSON obj:
<div id='json'>5</div>
Person obj:
<div id='person'>6</div>
Object save:
<div id='saveData'>7</div>
Object get:
<div id='getData'>8</div>

<div id="listcontainer">
  <ul id="list">
    <li>Incorporate a YouTube viewer into profile pages so owners can add video lectures and other presentations to their profile. Videos are hosted in the cloud, via the free YouTube service.
    </li>
    <li>2</li>
    <li>3</li>
  </ul>
</div> 


<!-- Fetch a person and friends code for OpenSocial 0.9 -->
<div>
  <a href="#" class="normal" onclick='window.oslib.fetchPeople();'>Fetch</a>
  <div>
    <span id='viewer'></span>
    <ul id='friends'></ul>
  </div>
</div>

<!-- Posting activity code for OpenSocial 0.9 -->
<div>
  <input type='text' id='title' />
  <button onclick='window.oslib.postActivity();'>Post activity</button>
  <div id='result_activity'></div>
</div>

<!-- Sharing appdata with friends for OpenSocial 0.9 -->
<div>
  <input type='text' id='content' />
  <button onclick='window.oslib.shareData();'>Share data</button>
  <button onclick='window.oslib.fetchFriendData();'>Fetch friend's data</button>
  <div id='result_appdata'></div>
  <ul id='contents'></ul>
</div>

<script type="text/javascript">
  
  //gadgets.util.registerOnLoadHandler(init);
  /*
  document.getElementById('fname').innerHTML = window.oslib.getFirstName();
  document.getElementById('lname').innerHTML = window.oslib.getLastName(); 
  document.getElementById('url').innerHTML = window.oslib.generateUrl();
  gadgets.window.adjustHeight();  
  */
  /*
  document.getElementById('url').innerHTML = window.oslib.test();
  window.oslib.makeResquest(function(){  
    gadgets.window.adjustHeight();  
  });
  */
  
  //gadgets.util.registerOnLoadHandler(init2);

  document.getElementById('fname').innerHTML = getFirstName();
  document.getElementById('lname').innerHTML = getLastName(); 
  document.getElementById('url').innerHTML = generateUrl();
  //makeRequest(function(){alert('yes');});
  LoadClinicalTrials();
  gadgets.window.adjustHeight(); 

  saveData(function(result){
    document.getElementById('saveData').innerHTML = JSON.stringify(result);
  });

  getData(function(result){
    document.getElementById('getData').innerHTML = JSON.stringify(result);
  });

  function getFirstName(){
    return "Brian";
  }; 

  function getLastName(){
    return "Francis";
  };

  function generateUrl(){
    return "http://scctsi-ctds-staging.herokuapp.com/1/clinical_trials/?pi_full_name=Brian Francis";
  };

  function makeRequest(callback){
    $.getJSON(generateUrl(), function(result){
      var cnt = 0;
      cnt = result.count;
      document.getElementById('json').innerHTML = cnt;
    });
    if(callback){
      callback();
    }
  };

  function LoadClinicalTrials(callback){
    osapi.people.get({
      userId: '@owner',
      groupId: '@self',
      appId: '@app',
      fields: ['name']
    }).execute(function(result) {
      //document.getElementById('person').innerHTML = (JSON.stringify(result));
      document.getElementById('person').innerHTML = result.name.familyName + " " + result.name.givenName;
      gadgets.window.adjustHeight(); 
    });
  };

  function saveData(callback){
    osapi.appdata.update({userId: '@owner', data: {myObj: 'a crazed monkey'}}).execute(callback);
  }

  function getData(callback){
    osapi.appdata.get({userId: '@owner', groupId: '@self', keys: ['myObj']}).execute(callback);  
  }

/*
  // test code

  function init(){
    $(document).ready(function(){
      $("#list").sortable();
      $("#list").disableSelection();
    });
    
    //makeRequest();
    
    gadgets.window.adjustHeight(); 
  }

  function makeRequest(callback){
  $.getJSON(generateUrl(), function(result){
    html = '';
    if(result.count > 0){
      html += '<div id="listcontainer"><ul id="list">';
      for(var i=0; i<result.count; i++){
        html += '<li class="list-item">' + result.response[i].officialTitle + '<br>' + 
        result.response[i].enrollmentStatus + '<br>' + result.response[i].diseaseArea + '</li>';
      }
      html += '</ul></div>';
    }
    console.log(html);
    document.getElementById('json').innerHTML = html;
    if(callback){
      callback();
    }
    gadgets.window.adjustHeight();   
  });
*/
</script>


  ]]>

  </Content>
</Module>